geom_errorbar(aes(ymin = conf.low, ymax = conf.high),
width = 0.3,  # 橫線寬
linewidth = 1.2,  # 垂直線粗
position = position_dodge(width = 0.9)) +
geom_text(aes(label = scales::percent(predicted, accuracy = 1),
y = conf.high + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 4) +
labs(title = "Model-Predicted Accuracy by BA and Mode",
x = "BA",
y = "Predicted Accuracy",
fill = "Mode") +
ylim(0, 1.15) +
theme_minimal()
ggplot(pred, aes(x = x, y = predicted, fill = group)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high),
width = 0.2, position = position_dodge(width = 0.9)) +
geom_text(aes(label = scales::percent(predicted, accuracy = 1),
y = conf.high + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 4) +
labs(title = "Model-Predicted Accuracy by BA and Mode",
x = "BA",
y = "Predicted Accuracy",
fill = "Mode") +
ylim(0, 1.15) +  # 給標籤留空間
theme_minimal()
summary(m)
ggplot(pred, aes(x = x, y = predicted, fill = group)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high),
width = 0.2, position = position_dodge(width = 0.9)) +
geom_text(aes(label = scales::percent(predicted, accuracy = 1),
y = conf.high + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 4) +
labs(title = "Accuracy by BA and Mode",
x = "BA",
y = "Predicted Accuracy",
fill = "Mode") +
ylim(0, 1.15) +  # 給標籤留空間
theme_minimal()
p = ggplot(data = emilySE, aes(x = BA, y = Accuracy, fill = mode)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
width = 0.2, position = position_dodge(0.9)) +
facet_wrap(~ Category) +
geom_text(aes(label = scales::percent(Accuracy, accuracy = 1)),
position = position_dodge(width = 0.9), vjust = -0.5, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Accuracy by BA and Mode",
x = "BA",
y = "Accuracy") +
theme_minimal()
print(p)
p = ggplot(data = emilySE, aes(x = BA, y = Accuracy, fill = mode)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
width = 0.2, position = position_dodge(0.9)) +
facet_wrap(~ Category) +
geom_text(aes(label = scales::percent(Accuracy, accuracy = 1),
y = Accuracy + ci + 0.02),  # <-- 關鍵：提高標籤位置
position = position_dodge(width = 0.9), vjust = 0, size = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Accuracy by BA and Mode",
x = "BA",
y = "Accuracy") +
ylim(0, 1.1) +  # 建議多留點空間
theme_minimal()
print(p)
print(p)
install.packages("stringr")
library(stringr)
print(p)
print(p)
print(p)
ggplot(pred, aes(x = x, y = predicted, fill = group)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high),
width = 0.2, position = position_dodge(width = 0.9)) +
geom_text(aes(label = scales::percent(predicted, accuracy = 1),
y = conf.high + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 4) +
labs(title = "Accuracy by BA, Mode, and Category",
x = "BA",
y = "Predicted Accuracy",
fill = "Mode") +
ylim(0, 1.15) +  # 給標籤留空間
theme_minimal()
ggplot(pred, aes(x = x, y = predicted, fill = group)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high),
width = 0.2, position = position_dodge(width = 0.9)) +
geom_text(aes(label = scales::percent(predicted, accuracy = 1),
y = conf.high + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 4) +
labs(title = "Accuracy by BA and Mode",
x = "BA",
y = "Predicted Accuracy",
fill = "Mode") +
ylim(0, 1.15) +  # 給標籤留空間
theme_minimal()
p = ggplot(data = emilySE, aes(x = BA, y = Accuracy, fill = mode)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
width = 0.3, linewidth = 1.2,
position = position_dodge(0.9)) +
geom_text(aes(label = scales::percent(Accuracy, accuracy = 1),
y = Accuracy + ci + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 3) +
facet_wrap(~ Category, nrow = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Accuracy by BA and Mode and Category",
x = "BA",
y = "Accuracy") +
ylim(0, 1.15) +
theme_minimal()
print(p)
print(p)
print(p)
print(p)
print(p)
print(p)
print (emilySE)
print(p)
print(p)
p = ggplot(data = emilySE, aes(x = BA, y = Accuracy, fill = mode)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
width = 0.3, linewidth = 0.2,
position = position_dodge(0.9)) +
geom_text(aes(label = scales::percent(Accuracy, accuracy = 1),
y = Accuracy + ci + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 3) +
facet_wrap(~ Category, nrow = 1) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Accuracy by BA and Mode and Category",
x = "BA",
y = "Accuracy") +
ylim(0, 1.15) +
theme_minimal()
print(p)
p = ggplot(data = emilySE, aes(x = BA, y = Accuracy, fill = mode)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
width = 0.5, linewidth = 0.2,
position = position_dodge(0.9)) +
geom_text(aes(label = scales::percent(Accuracy, accuracy = 1),
y = Accuracy + ci + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 3) +
facet_wrap(~ Category, nrow = 1) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Accuracy by BA and Mode and Category",
x = "BA",
y = "Accuracy") +
ylim(0, 1.15) +
theme_minimal()
print(p)
p = ggplot(data = emilySE, aes(x = BA, y = Accuracy, fill = mode)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
width = 0.5, linewidth = 0.2,
position = position_dodge(0.9)) +
geom_text(aes(label = scales::percent(Accuracy, accuracy = 1),
y = Accuracy + ci + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 3) +
facet_wrap(~ Category, nrow = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Accuracy by BA and Mode and Category",
x = "BA",
y = "Accuracy") +
ylim(0, 1.15) +
theme_minimal()
print(p)
library(stringr)
emilySE$Category <- str_wrap(emilySE$Category, width = 15)
p = ggplot(data = emilySE, aes(x = BA, y = Accuracy, fill = mode)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
width = 0.5, linewidth = 0.2,
position = position_dodge(0.9)) +
geom_text(aes(label = scales::percent(Accuracy, accuracy = 1),
y = Accuracy + ci + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 3) +
facet_wrap(~ Category, nrow = 3) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Accuracy by BA and Mode and Category",
x = "BA",
y = "Accuracy") +
ylim(0, 1.15) +
theme_minimal()
print(p)
p = ggplot(data = emilySE, aes(x = BA, y = Accuracy, fill = mode)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
width = 0.5, linewidth = 0.2,
position = position_dodge(0.9)) +
geom_text(aes(label = scales::percent(Accuracy, accuracy = 1),
y = Accuracy + ci + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 3) +
facet_wrap(~ Category, nrow = 4) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Accuracy by BA and Mode and Category",
x = "BA",
y = "Accuracy") +
ylim(0, 1.15) +
theme_minimal()
print(p)
p = ggplot(data = emilySE, aes(x = BA, y = Accuracy, fill = mode)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
width = 0.5, linewidth = 0.2,
position = position_dodge(0.9)) +
geom_text(aes(label = scales::percent(Accuracy, accuracy = 1),
y = Accuracy + ci + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 3) +
facet_wrap(~ Category, nrow = 1) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Accuracy by BA and Mode and Category",
x = "BA",
y = "Accuracy") +
ylim(0, 1.15) +
theme_minimal()
print(p)
library(Rmisc)
library(Rmisc)
library(dplyr)
library(ggplot2)
library(scales)
library(stringr)
library(lme4)
library(lmerTest)
library(ggeffects)
print(p)
p <- ggplot(data = emilySE, aes(x = BA, y = Accuracy, fill = mode)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
width = 0.3, linewidth = 0.2,
position = position_dodge(0.9)) +
geom_text(aes(label = scales::percent(Accuracy, accuracy = 1),
y = Accuracy + ci + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 3) +
facet_wrap(~ Category, nrow = 2, scales = "free_x") +  # 分成 2 列，且讓每個 facet 可以自己調整寬度
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) +  # 調整 x 軸文字大小與角度
labs(title = "Accuracy by BA and Mode and Category",
x = "BA",
y = "Accuracy") +
coord_cartesian(ylim = c(0, 1.15)) +  # 不裁掉資料
theme_minimal(base_size = 12) +  # 整體字體大小
theme(strip.text = element_text(size = 10),  # facet 標題字體大小
panel.spacing = unit(1, "lines"))  # 增加 facet 間距
print(p)
emily <- read.csv(file.choose(), stringsAsFactors = FALSE, fileEncoding = "UTF-8")
print(ChatGPT_summary)
emily[[col]] <- as.factor(emily[[col]])
print(ChatGPT_summary)
ChatGPT_summary <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
print(ChatGPT_summary)
emilySE <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = c("BA", "mode", "Category"),
na.rm = TRUE)
print(emilySE)
human_summary <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
print(human_summary)
print(ChatGPT_summary)
ChatGPT_summary <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = c("Category","ChatGPT"),
na.rm = TRUE)
ChatGPT_summary <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = c("Category","mode_ChatGPT"),
na.rm = TRUE)
chatgpt_data <- subset(emily, mode == "ChatGPT")
ChatGPT_summary <- summarySE(data = chatgpt_data,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
print(ChatGPT_summary)
chatgpt_data <- subset(emily, mode == "human")
human_summary <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
print(human_summary)
human_data <- subset(emily, mode == "human")
human_summary <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
print(human_summary)
Ba_Model_data <- subset(emily, mode == "Ba Model")
Ba_Model_summary <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
print(Ba_Model_summary)
Ba_Model_data <- subset(emily, mode == "Ba Model")
Ba_Model_summary <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
print(Ba_Model_summary)
chatgpt_data <- subset(emily, mode == "ChatGPT")
ChatGPT_summary <- summarySE(data = chatgpt_data,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
print(ChatGPT_summary)
emilySE <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = c("BA", "mode", "Category"),
na.rm = TRUE)
print(emilySE)
chatgpt_data <- subset(emily, mode == "ChatGPT")
ChatGPT_summary <- summarySE(data = chatgpt_data,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
print(ChatGPT_summary)
write_xlsx(accuracy_by_Chatgpt, "aggregate_accuracy_ChatGPT_summary.xlsx")
write_xlsx(ChatGPT_summary, "aggregate_accuracy_ChatGPT_summary.xlsx")
install.packages("writexl")
library(writexl)
write_xlsx(ChatGPT_summary, "aggregate_accuracy_ChatGPT_summary.xlsx")
human_data <- subset(emily, mode == "human")
human_summary <- summarySE(data = human_data,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
print(human_summary)
write_xlsx(human_summary, "aggregate_accuracy_human_summary.xlsx")
getwd()
setwd("C:\Users\Emily\Desktop\R data_analysis")
setwd("C:/Users/Emily/Desktop/R data_analysis")
write_xlsx(human_summary, "aggregate_accuracy_human_summary.xlsx")
Ba_Model_summary <- summarySE(data = Ba_Model_data,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
Ba_Model_data <- subset(emily, mode == "Ba Model")
Ba_Model_summary <- summarySE(data = Ba_Model_data,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
View(emily)
view(emilySE)
View(emilySE)
print(Ba_Model_summary)
Ba_Model_data <- subset(emily, mode == "Ba Model")
Ba_Model_summary <- summarySE(data = Ba_Model_data,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
Ba_Model_summary <- summarySE(data = BaModel_data,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
Ba_Model_summary <- summarySE(data = Ba Model_data,
Ba_Model_summary <- summarySE(data = BA Model_data,
Ba_Model_data <- subset(emily, mode == "BA Model")
Ba_Model_summary <- summarySE(data = BA Model_data,
Ba_Model_summary <- summarySE(data = BA_Model_data,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
Ba_Model_data <- subset(emily, mode == "BA Model")
BA_Model_data <- subset(emily, mode == "BA Model")
BA_Model_summary <- summarySE(data = BA_Model_data,
measurevar = "Accuracy",
groupvars = c("Category"),
na.rm = TRUE)
print(BA_Model_summary)
write_xlsx(BA_Model_summary, "aggregate_accuracy_BA_Model_summary.xlsx")
p <- ggplot(data = emilySE, aes(x = BA, y = Accuracy, fill = mode)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
width = 0.3, linewidth = 0.2,
position = position_dodge(0.9)) +
geom_text(aes(label = scales::percent(Accuracy, accuracy = 1),
y = Accuracy + ci + 0.02),
position = position_dodge(width = 0.9),
vjust = 0, size = 3) +
facet_wrap(~ Category, nrow = 2, scales = "free_x") +  # 分成 2 列，且讓每個 facet 可以自己調整寬度
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) +  # 調整 x 軸文字大小與角度
labs(title = "Accuracy by BA and Mode and Category",
x = "BA",
y = "Accuracy") +
coord_cartesian(ylim = c(0, 1.15)) +  # 不裁掉資料
theme_minimal(base_size = 12) +  # 整體字體大小
theme(strip.text = element_text(size = 10),  # facet 標題字體大小
panel.spacing = unit(1, "lines"))  # 增加 facet 間距
print(p)
mode_accuracy <- emily %>%
group_by(mode) %>%
summarise(mean_accuracy = mean(Accuracy, na.rm = TRUE))
print(mode_accuracy)
aggregate(Accuracy ~ item * mode, emily, mean)
names(emily)[names(emily) == "Spreadsheet..test.items"] <- "item"
aggregate(Accuracy ~ item * mode, emily, mean)
print(emilySE)
Human_data<- subset(emily, mode == "human")
accuracy_by_human<- aggregate(Accuracy ~ Participant, data = human_data, FUN = mean)
print(accuracy_by_human)
human_summary_2 <- summarySE(data = human_data,
measurevar = "Accuracy",
groupvars = human,
na.rm = TRUE)
print(human_summary)
human_summary_2 <- summarySE(data = human_data,
measurevar = "Accuracy",
groupvars = human,
na.rm = TRUE)
human_summary_2 <- summarySE(data = human_data,
measurevar = "Accuracy",
groupvars = "Participant",
na.rm = TRUE)
print(human_summary_2)
human_summary_2 <- summarySE(data = human_data,
measurevar = "Accuracy",
groupvars = "BA",
na.rm = TRUE)
human_summary_BA <- summarySE(data = human_data,
measurevar = "Accuracy",
groupvars = "BA",
na.rm = TRUE)
print(human_summary_BA)
human_summary_participant <- human_data %>%
group_by(Participant) %>%
summarise(
response_count = n(),              # 回答次數（資料行數）
mean_accuracy = mean(Accuracy, na.rm = TRUE)  # 平均 Accuracy
p_trend <- ggplot(human_summary_participant, aes(x = response_count, y = mean_accuracy)) +
print(p_trend)
p_trend <- ggplot(human_summary_participant, aes(x = response_count, y = mean_accuracy)) +
geom_point(color = "blue", size = 3, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "red") +  # 加上線性迴歸趨勢線
labs(title = "Human Mode: Participant Response Count vs. Mean Accuracy",
x = "回答次數 (Response Count)",
y = "平均 Accuracy (Mean Accuracy)") +
theme_minimal()
human_summary_participant <- human_data %>%
group_by(Participant) %>%
summarise(
response_count = n(),              # 回答次數（資料行數）
mean_accuracy = mean(Accuracy, na.rm = TRUE)  # 平均 Accuracy
)
p_trend <- ggplot(human_summary_participant, aes(x = response_count, y = mean_accuracy)) +
geom_point(color = "blue", size = 3, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "red") +  # 加上線性迴歸趨勢線
labs(title = "Human Mode: Participant Response Count vs. Mean Accuracy",
x = "回答次數 (Response Count)",
y = "平均 Accuracy (Mean Accuracy)") +
theme_minimal()
print(p_trend)
print(BA_Model_summary)
BA_Model_summary_BA <- summarySE(data = BA_Model_data,
measurevar = "Accuracy",
groupvars = "BA",
na
print(BA_Model_summary_BA)
print(BA_Model_summary_BA)
BA_Model_summary_BA <- summarySE(data = BA_Model_data,
measurevar = "Accuracy",
groupvars = "BA",
na.rm = TRUE)
print(BA_Model_summary_BA)
print(emilySE)
emilySE_BA <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = c("BA", "mode"),
na.rm = TRUE)
print(emilySE_BA)
write_xlsx(accuracy_by_emilySE_BA, "emilySE_BA.xlsx")
write_xlsx(emilySE_BAA, "emilySE_BA.xlsx")
write_xlsx(emilySE_BA, "emilySE_BA.xlsx")
print(p)
summary(m)
print(mode_accuracy)
[0.9856, 0.9944]
print(emilySE)
print(emilySE_BA)
emilySE_mode <- summarySE(data = emily,
measurevar = "Accuracy",
groupvars = ("mode"),
na.rm = TRUE)
print(emilySE_mode)
write_xlsx(emilySE_mode, "emilySE_BA.xlsx")
write_xlsx(emilySE_mode, "emilySE_BA.xlsx")
write_xlsx(emilySE_mode, "emilySE_BA.xlsx")
print(BA_Model_summary_BA)
accuracy_by_BA_Model<- aggregate(Accuracy ~ Participant, data = BA_Model_data, FUN = mean)
print(accuracy_by_BA_Model)
write_xlsx(accuracy_by_BA_Model, "aggregate_accuracy_by_participant_BA_Model.xlsx")
